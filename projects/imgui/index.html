<!DOCTYPE html><html lang="en" data-astro-transition-scope="astro-smooz4hq-1"> <head><meta charset="utf-8"><meta name="description" content="Astro description"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="preload" href="https://fonts.googleapis.com/css2?family=Josefin+Sans&family=Pacifico&display=swap" as="style"><link href="https://fonts.googleapis.com/css2?family=Josefin+Sans&family=Pacifico&display=swap" rel="stylesheet"><meta name="generator" content="Astro v4.16.7"><title>Immediate-mode UI library</title><style>#themeToggle[data-astro-cid-oemx5le4]{border:0;background:none}#themeToggle[data-astro-cid-oemx5le4]:hover{cursor:pointer;rotate:10deg}.moon[data-astro-cid-oemx5le4]{fill:#fdebf3}.sun[data-astro-cid-oemx5le4],.light .moon[data-astro-cid-oemx5le4]{fill:transparent}.light .sun[data-astro-cid-oemx5le4]{fill:#1e1e2e}@keyframes astroFadeInOut{0%{opacity:1}to{opacity:0}}@keyframes astroFadeIn{0%{opacity:0;mix-blend-mode:plus-lighter}to{opacity:1;mix-blend-mode:plus-lighter}}@keyframes astroFadeOut{0%{opacity:1;mix-blend-mode:plus-lighter}to{opacity:0;mix-blend-mode:plus-lighter}}@keyframes astroSlideFromRight{0%{transform:translate(100%)}}@keyframes astroSlideFromLeft{0%{transform:translate(-100%)}}@keyframes astroSlideToRight{to{transform:translate(100%)}}@keyframes astroSlideToLeft{to{transform:translate(-100%)}}@media (prefers-reduced-motion){::view-transition-group(*),::view-transition-old(*),::view-transition-new(*){animation:none!important}[data-astro-transition-scope]{animation:none!important}}
:root{--background: #1e1e2e;--background-light: #ffffff;--button: #78c2ad;--text: #fff7f7;--text-light: #2e2a1e;--text-link: #78c2ad;--underline: #375a7f;--header: "Cambria";--body: "Josefin Sans", sans-serif}html{background-color:var(--background);color:var(--text)}body{max-width:780px;margin:0 auto;text-align:justify}h1,h2{font-family:var(--header);font-weight:400}h1{font-size:2.6rem;margin:0 0 5px}h2{text-decoration:underline var(--underline);text-decoration-thickness:4px;text-underline-offset:7px;font-size:2.1rem;margin-bottom:0}p{font-family:var(--body);font-size:1.1rem;hyphens:None;line-height:1.5;text-indent:1rem}small,li{font-family:var(--body)}.navbar{display:grid;grid-template-columns:1fr 1fr;margin-top:.8rem}.navbar__title{font-family:var(--header);font-size:1.3rem}.navbar__menu{font-family:var(--body);font-size:1.1rem;text-align:right}.navbar__title>a,.navbar__menu>a{color:var(--text);text-decoration:none}.navbar__menu>a{margin:0 10px}.navbar__title>a:hover,.navbar__menu>a:hover,.navbar__menu>a:focus{text-decoration:underline var(--underline);text-decoration-thickness:2px;text-underline-offset:6px}.gif{margin:20px 0 0;text-align:center}.badge{background-color:#494b66;color:var(--text);border-radius:6px;font-family:var(--body);font-weight:600;font-size:.85rem;padding:.3em .6em .2em;margin-right:3px}.badge__list{text-indent:1rem;list-style:none;padding:0}.badge__list>li{margin-top:10px}.badge--item{border-radius:4px;font-size:.7rem;margin-right:5px;padding:.5em .3em .3em}.badge__link{color:var(--text-link);text-decoration:none}.badge__link:hover{text-decoration:underline}.card{list-style:none;display:flex;background-size:400%;padding:20px}.card__link{width:100%;text-decoration:none;line-height:1.4;border-radius:8px;color:var(--text)}.card__img{border-radius:5px}.card__title{margin:0;font-family:var(--body);font-size:1.5rem;font-weight:400;text-align:left}.card__txt{font-size:1rem;line-height:1.5;text-indent:0;text-align:left;margin:.5rem 0 0}.card__link:hover{transform:scale(1.05)}.link-card-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(50ch,1fr));gap:1rem;padding:0}.btn{text-align:center;background:#0000;border:2px solid var(--button);border-radius:8px;color:var(--text);font:600 16px var(--body);padding:8px 16px;transition:background-color .4s,color .4s}.btn:hover{background-color:var(--button);color:var(--text-light);cursor:pointer}.skills{margin-top:8px}.skills__img{margin:8px 4px}.center{text-align:center}.pro-img{border-radius:16px;margin-top:10px}footer{margin:4rem 0}.footer__link{color:var(--text-link);text-decoration:none}.footer{cursor:default;list-style:none;padding:0}.icon__btn{display:inline-block;padding:0 .5rem}.icon__link{display:flex;padding:10px;height:20px;width:20px;border-radius:50%;border:2px solid #fdebf3}.icon__link:hover{border-color:var(--text-link)}.git-icon{content:url(/github-mark-white.svg)}.mail-icon{content:url(/mail-white.svg)}.linked-in{content:url(/li-in-white.png)}.lost{margin-top:30%;text-align:center}.lost__header{margin:0 auto;text-align:center;border:0;font-size:7.5rem;letter-spacing:10px}.lost__body{color:#5c5b77}.lost__link{color:var(--text-link);text-decoration:none}html.light{background-color:var(--background-light);color:var(--text-light)}.light .navbar__title>a{color:var(--text-light)}.light .navbar__menu>a{color:var(--text-light)}.light .card__title,.light .card__txt,.light .btn{color:var(--text-light)}.light .btn:hover{color:var(--text)}.light .icon__link{border:2px solid var(--text-light)}.light .icon__link:hover{border-color:var(--text-link)}.light .git-icon{content:url(/github-mark.svg)}.light .mail-icon{content:url(/mail.svg)}.light .linked-in{content:url(/li-in.png)}.light .badge__link{color:var(--text-link)}@media only screen and (max-width: 600px){body{width:350px}.navbar{display:initial}.navbar__title,.navbar__menu{text-align:center}.navbar__menu>a{margin:0 11px}.skills__img{height:30px;width:30px;margin:8px 1px}.badge__list{font-size:.9rem;text-indent:0}.pro-img{height:auto;width:350px}}
</style><script type="module">function e(){localStorage.theme==="light"||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: light)").matches?document.documentElement.classList.add("light"):document.documentElement.classList.remove("light")}e();document.addEventListener("astro:after-swap",e);
</script><style>[data-astro-transition-scope="astro-smooz4hq-1"] { view-transition-name: astro-smooz4hq-1; }@layer astro { ::view-transition-old(astro-smooz4hq-1) { animation: none; opacity: 0; mix-blend-mode: normal; }::view-transition-new(astro-smooz4hq-1) { animation: none; mix-blend-mode: normal; }::view-transition-group(astro-smooz4hq-1) { animation: none } }[data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-smooz4hq-1"],
			[data-astro-transition-fallback="old"][data-astro-transition-scope="astro-smooz4hq-1"] { animation: none; mix-blend-mode: normal; }[data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-smooz4hq-1"],
			[data-astro-transition-fallback="new"][data-astro-transition-scope="astro-smooz4hq-1"] { animation: none; mix-blend-mode: normal; }</style></head> <body> <header> <nav data-astro-transition-persist="astro-c3mo5b3h-2"> <div class="navbar"> <div class="navbar__title"></div> <div class="navbar__menu"> <a href="/">Home</a> <a href="https://github.com/eeromutka" target="_blank">GitHub</a> <button id="themeToggle" title="Theme Toggle" data-astro-cid-oemx5le4> <svg width="30px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" data-astro-cid-oemx5le4> <path class="sun" fill-rule="evenodd" d="M12 17.5a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zm0 1.5a7 7 0 1 0 0-14 7 7 0 0 0 0 14zm12-7a.8.8 0 0 1-.8.8h-2.4a.8.8 0 0 1 0-1.6h2.4a.8.8 0 0 1 .8.8zM4 12a.8.8 0 0 1-.8.8H.8a.8.8 0 0 1 0-1.6h2.5a.8.8 0 0 1 .8.8zm16.5-8.5a.8.8 0 0 1 0 1l-1.8 1.8a.8.8 0 0 1-1-1l1.7-1.8a.8.8 0 0 1 1 0zM6.3 17.7a.8.8 0 0 1 0 1l-1.7 1.8a.8.8 0 1 1-1-1l1.7-1.8a.8.8 0 0 1 1 0zM12 0a.8.8 0 0 1 .8.8v2.5a.8.8 0 0 1-1.6 0V.8A.8.8 0 0 1 12 0zm0 20a.8.8 0 0 1 .8.8v2.4a.8.8 0 0 1-1.6 0v-2.4a.8.8 0 0 1 .8-.8zM3.5 3.5a.8.8 0 0 1 1 0l1.8 1.8a.8.8 0 1 1-1 1L3.5 4.6a.8.8 0 0 1 0-1zm14.2 14.2a.8.8 0 0 1 1 0l1.8 1.7a.8.8 0 0 1-1 1l-1.8-1.7a.8.8 0 0 1 0-1z" data-astro-cid-oemx5le4></path> <path class="moon" fill-rule="evenodd" d="M16.5 6A10.5 10.5 0 0 1 4.7 16.4 8.5 8.5 0 1 0 16.4 4.7l.1 1.3zm-1.7-2a9 9 0 0 1 .2 2 9 9 0 0 1-11 8.8 9.4 9.4 0 0 1-.8-.3c-.4 0-.8.3-.7.7a10 10 0 0 0 .3.8 10 10 0 0 0 9.2 6 10 10 0 0 0 4-19.2 9.7 9.7 0 0 0-.9-.3c-.3-.1-.7.3-.6.7a9 9 0 0 1 .3.8z" data-astro-cid-oemx5le4></path> </svg> </button>  <script>
    const theme = (() => {
        if (typeof localStorage !== 'undefined' && localStorage.getItem('theme')) {
            return localStorage.getItem('theme');
        }
        if (window.matchMedia('(prefers-color-scheme: light)').matches) {
            return 'light';
        }
        return 'dark';
    })();

    if (theme === 'dark') {
        document.documentElement.classList.remove('light');
    } else {
        document.documentElement.classList.add('light');
    }

    window.localStorage.setItem('theme', theme);

    const handleToggleClick = () => {
        const element = document.documentElement;
        element.classList.toggle("light");

        const isLight = element.classList.contains("light");
        localStorage.setItem("theme", isLight ? "light" : "dark");
    }

    document.getElementById("themeToggle").addEventListener("click", handleToggleClick);
</script> </div> </div> </nav> </header> <main>  <h2>Immediate-mode UI library</h2>  <p><span class="badge">C++</span>
<br>
Immediate-mode UI library with auto-layout for easily making intuitive UIs with buttons, text boxes, color pickers, and more!</p>
<p><a href="https://github.com/EeroMutka/Fire">Link to the GitHub page</a></p>
<h2>Features</h2>
<br>
<iframe allow="fullscreen;" width="100%" height="400" src="https://www.youtube.com/embed/7fb1C4dI8pw" &#x22;=""></iframe>
<ul></ul>
<li>Buttons <i>(0:00)</i></li>
<li>Number edit boxes <i>(0:04)</i></li>
<li>Text edit boxes <i>(0:14)</i></li>
<li>Checkboxes <i>(0:30)</i></li>
<li>Auto-layout algorithm with flexible size modes <i>(0:34)</i></li>
<li>Color picker <i>(0:40)</i></li>
<li>Rearrangeable boxes <i>(0:58)</i></li>
<li>Scroll-regions <i>(1:10)</i></li>
<li>Dropdown menus <i>(1:35)</i></li>
<li>Keyboard navigation <i>(1:47)</i></li>
<h2>Implementation</h2>
<p>The typical way to build a UI system is to use the so-called retained-mode style. There's typically an object-oriented class hierarchy of widget types which the user manually instantiates and manages. In immediate-mode style, the user doesn't manage the UI objects explicitly, but rather generates the entire UI each frame from scratch. This means that the UI object don't need to be manually updated whenever something changes in the user program, and it's thus easier and less error-prone to make dynamic UIs. Dear ImGui popularized this paradigm, and I wanted my code to follow a similar pattern.</p>
<p>The basis of my UI system is a hierarchical tree of "boxes" that get placed one after another vertically or horizontally. A box is a rectangle with a set of customizable and optional behaviours. For example, to make a button, you would add a "box" with the behaviours "has text", "clickable", "draw border" and "draw background". This could of course be wrapped in an "AddButton" function, but the point is that composition makes it easy to customize and build specialized UI widgets. This idea is talked about in depth in Ryan Fleury's <a href="https://www.rfleury.com/p/ui-part-1-the-interaction-medium">UI Articles</a>, which were a great learning resource for me.</p>
<h2>Messages</h2>
<p>In immediate-mode UIs, it's common to process and return input messages immediately as widgets are added, hence the name "immediate-mode". For example, Dear Imgui's `Button()` function returns a boolean that says if it has been pressed. This is convenient, as code which is logically related to that button can be implemented right then and there. There is just one problem: if we have a smart layouting system with flexible elements, like I do, then the box rectangles can only be calculated once the entire UI has been built. So while we're adding a button and in the middle of some UI generation code, how can we check if the mouse has clicked inside a rectangle that cannot yet be determined? My solution is to use the rectangle from last frame for checking mouse overlaps. We must then identify the boxes using "keys" for looking up information from the previous frame. Giving keys to the boxes becomes necessary for other reasons as well, such as for storing the "active" box for keyboard navigation, text input, etc.</p>
<p>There are multiple possible ways to go about keying. Dear Imgui hashes the name of a box and allows for providing extra hashing digits at the end of names. The problem is that not all UI boxes have names, or multiple boxes might share the same name. In my UI, keys must be provided explicitly for all boxes and are 64-bit integers. To make dealing with keys easier, the provided UI_KEY() macro expands into a callsite-unique key and relies on some __COUNTER__ and __FILE__ hashing trickery. Using UI_KEY() is usually enough, but if the same code gets called multiple times in a frame, then more information is needed to separate them into unique keys, or otherwise the code asserts. To separate the keys, the UI_KEY1() or UI_KEY2() macros may be used to hash together other keys into new, unique ones. Examples of this can be found in the UI demo code as well as the fire_ui library itself.</p>
<h2>Drawing</h2>
<p>After the box tree has been built and the rectangles have been calculated, it gets drawn to the screen. Originally, my drawing code was similar to Fleury's, where rectangles are submitted to the GPU and rendered using signed distance functions with parameters for edge roundness, softness, thickness, etc. I also defined a few other shapes like circles. I scrapped it in favour of Dear Imgui-style rendering, where you build and submit a regular vertex buffer each frame, where each vertex has a position and a color and optionally a texture. All geometry is then generated on the CPU, but because of this it's also more flexible. A new library user can look at the provided drawing functions, copy code from it, make variations, and do whatever they like, all without touching any shader code.</p>
<h2>Code composition</h2>
<p>Designing the library has been an excercise in code composition and extensibility. The requirements for UI widgets can vary a lot per application. Implementing all imaginable features directly into the library core would make it really complicated, and in turn, more difficult to work with and to extend. It would also just be impossible. That's why whenever I've wanted to make a new UI widget, I've asked myself: how easy is it to build it in the application code without modifying the library itself? If this is easy for the majority of the times, then the library is well structured. Even if some UI widget is broadly useful enough to include as part of the UI library, it's still great if it can be separated to keep it self-contained and to keep the library core simple.</p>
<p>There are a few principles that can improve extensibility. The most obvious way is to provide lots of styling parameters: text color, border roundness, etc. But that's only possible to a certain point. The second way is to avoid "private" or "internal" library functions. If all the UI functions are public, easy-to-understand, and well-documented, then <i>in theory</i> the user can just copy one, tweak it, and call it instead of the library-provided function. The problem is, if the function is deep within a call hierarchy of some other functions, then the caller functions need to be duplicated as well. The way to break these nested call hierarchies is with customizable function pointers, they're sort of like styling parameters! For example, I store a function pointer per UI box for custom size calculation, and one for custom drawing. The third way to improve extensibility is to make the system more dynamically typed. Imagine that I wanted to make a new feature that required storing some data in a UI box. Naively, I would add a struct member to the UI_Box struct. But that would require tweaking the library code. To fix this, we can make it possible to attach arbitrary data into UI boxes using keys. I use this in many places around the library, and it has been a great help in making the code more flexible.</p>   <footer> <div class="center"> <ul class="footer"> <li class="icon__btn"><a class="icon__link" href="https://github.com/eeromutka" target="_blank"><span class="git-icon">GitHub</span></a></li> <li class="icon__btn"><a class="icon__link" href="mailto: eero.mutka@gmail.com"><span class="mail-icon">Email</span></a></li> <li class="icon__btn"><a class="icon__link" href="https://www.linkedin.com/in/eero-mutka/" target="_blank"><span class="linked-in">LinkedIn</span></a></li> </ul> <small>&copy; 2024 Eero Mutka</small> </div> </footer> </main>  </body> </html>